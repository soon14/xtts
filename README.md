# xtts
为中文小说生成语音朗读mp3

Convert Chinese Text novels to mp3 using Baidu AI API

本人是听书的爱好者，但是有很多小说，并找不到真人朗读的版本。而且有时候真人朗读反而会和你脑补的意境不同，影响听书的心情。反而是这种机器合成的声音，中性无特别的个性和情感，适应性更广。本人用此工具生成了数百小时的音频，成功的让自己的眼睛得到了相应时间的休息。

使用前你需要首先申请百度AI的账号，目前百度语音合成的API是免费的。申请完毕后，在代码中填入你的账号信息。另外需要提供小说章节的正则表达式，以便按照章节来进行语音合成。只支持Python3，python2的时代过去了。

由于百度语音合成API每次请求的文字数为1024，合成的语音文件不到5分钟，因此需要对小说的文字进行分割，然后将多个mp3文件合并。目前的分割主要以标点符号为依据，避免中途截断。很多网络小说每一章的内容也只有2~3千字，合成的内容不到10分钟，因此程序实现了多章合并的功能。由`chapters`参数控制每个mp3文件包含的章节数。同时一本长篇小说，要完成全部合成，需要较长时间，中途可能会发生意外中断，因此设计了`start`和`end`参数，控制开始和停止的章节编号。

大部分中文小说使用的是gb2312编码，也有部分是utf8，使用时要注意指定。

建议使用播客的客户端来播放生成的mp3，这样能记住播放的位置。特别推荐Overcast，upload功能简直是天作之合。安卓推荐Simple ABP。

使用示例
`python3 tts.py --book "dmwf.txt" --mp3prefix 大明武夫 --pattern "^第.*章\\s+.*" --chapters 16 --start 0 --id 你的API_KEY --secret 你的Secret_Key --speed 8 --person 0 --encoding utf8 --output mp3`

感谢百度云能够免费提供语音合成API。
